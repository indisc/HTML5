/*
 jCanvas v6.1b
Copyright 2012, Caleb Evans
Licensed under the MIT license
*/
(function(d,S,V,Q,W,v,F,h,z){function B(){}function G(c){c?A(X,c):G.prefs=X=B.prototype=A({},O);return this}function J(c,a){c.fillStyle=a.fillStyle;c.strokeStyle=a.strokeStyle;c.lineWidth=a.strokeWidth;a.rounded?(c.lineCap="round",c.lineJoin="round"):(c.lineCap=a.strokeCap,c.lineJoin=a.strokeJoin,c.miterLimit=a.miterLimit);c.shadowOffsetX=a.shadowX;c.shadowOffsetY=a.shadowY;c.shadowBlur=a.shadowBlur;c.shadowColor=a.shadowColor;c.globalAlpha=a.opacity;c.globalCompositeOperation=a.compositing}function y(c){return c&&
c.getContext?c.getContext("2d"):h}function M(c,a){a.closed&&c.closePath();c.fill();"transparent"!==a.fillStyle&&(c.shadowColor="transparent");c.stroke();a.closed||c.closePath();a._toRad&&c.restore();a.mask&&(a.autosave&&c.save(),c.clip())}function Y(c,a){if(!a.translateX&&!a.translateY&&(a.x||a.y))a.translateX=a.x,a.translateY=a.y;a.translate&&(a.translateX=a.translateY=a.translate);c.translate(a.translateX,a.translateY)}function Z(c,a){1!==a.scale&&(a.scaleX=a.scaleY=a.scale);c.translate(a.x,a.y);
c.scale(a.scaleX,a.scaleY);c.translate(-a.x,-a.y)}function $(c,a){a._toRad=a.inDegrees?D/180:1;a.rotate=a.rotate||a.angle;c.translate(a.x,a.y);c.rotate(a.rotate*a._toRad);c.translate(-a.x,-a.y)}function I(c,a,b,f,k){b._toRad=b.inDegrees?D/180:1;a.save();k=k||f;!c&&!b.fromCenter&&(b.x+=f/2,b.y+=k/2);(b.rotate||b.angle)&&$(a,b);(1!==b.scale||1!==b.scaleX||1!==b.scaleY)&&Z(a,b);(b.translate||b.translateX||b.translateY)&&Y(a,b)}function R(c){var a;E.elem===c?a=E.data:((a=d.data(c,"jCanvas"))||(a=d.data(c,
"jCanvas",{layers:[],intersects:[],drag:{},event:{}})),E.elem=c,E.data=a);return a}function aa(c,a,b){b&&b.visible&&(b.method===d.fn.draw?b.fn.call(c[0],a):b.method&&b.method.call(c,b))}function H(c,a,b){var f,k,g,C="function"===typeof a,q,a=a||{};if(a.layer&&!a._layer){f=d(c);k=f.getLayers();C&&(a={method:d.fn.draw,fn:a});a=A(new B,a);if(!C){a.method=d.fn[a.method]||b;q=R(c);for(g in G.events)G.events.hasOwnProperty(g)&&a[g]&&(G.events[g](f,q),a._event=v);if(a.draggable){a._event=v;c=["mousedown",
"mousemove","mouseup"];for(b=0;b<c.length;b+=1)g=c[b],G.events[g](f,q);q.mouseout||(f.bind("mouseout.jCanvas",function(){q.drag={};f.drawLayers()}),q.mouseout=v)}}a.layer=v;a._layer=v;a.index===z&&(a.index=k.length);k.splice(a.index,0,a)}}function ba(c){var a;for(a=0;a<K.length;a+=1)c[K[a]]=c["_"+K[a]]}function ca(c,a){var b;for(b=0;b<K.length;b+=1)c["_"+K[b]]=c[K[b]],T[K[b]]=1,a&&delete c[K[b]]}function da(c){var a,b,f=[],k=1;c.match(/^#?\w+$/i)&&("transparent"===c&&(c="rgba(0,0,0,0)"),b=S.head,
a=b.style.color,b.style.color=c,c=d.css(b,"color"),b.style.color=a);c.match(/^rgb/i)&&(f=c.match(/\d+/gi),c.match(/%/gi)&&(k=2.55),f[0]*=k,f[1]*=k,f[2]*=k,f[3]=f[3]!==z?W(f[3]):1);return f}function ga(c){var a=3,b;"object"!==typeof c.start&&(c.start=da(c.start),c.end=da(c.end));c.now=[];if(1!==c.start[3]||1!==c.end[3])a=4;for(b=0;b<a;b+=1)c.now[b]=c.start[b]+(c.end[b]-c.start[b])*c.pos,3>b&&(c.now[b]=P(c.now[b]));1!==c.start[3]||1!==c.end[3]?c.now="rgba("+c.now.join(",")+")":(c.now.slice(0,3),c.now=
"rgb("+c.now.join(",")+")");c.elem.nodeName?c.elem.style[c.prop]=c.now:c.elem[c.prop]=c.now}function N(c){G.events[c]=function(a,b){var f="mouseover"===c||"mouseout"===c?"mousemove":c,k=b.event;b[f]||(a.bind(f+".jCanvas",function(b){k.x=b.offsetX;k.y=b.offsetY;k.type=f;a.drawLayers(v);b.preventDefault()}),b[f]=v)}}function L(c,a,b){var c=R(c),f=c.event,a=a.isPointInPath(f.x,f.y);b.mouseX=f.x;b.mouseY=f.y;!a&&(b._hovered&&!b._fired)&&(b._mousedout=v);a&&c.intersects.push(b)}function ea(c,a,b,f,k){var g=
/\b(\d*\.?\d*)\w\w\b/gi,C;if(E.text===f.text&&E.font===f.font&&E.maxWidth===f.maxWidth&&E.lineHeight===f.lineHeight)f.width=E.width,f.height=E.height;else if(!a){f.width=b.measureText(k[0]).width;for(a=1;a<k.length;a+=1)C=b.measureText(k[a]).width,C>f.width&&(f.width=C);b=c.style.fontSize;if(a=f.font.match(g))c.style.fontSize=f.font.match(g)[0];f.height=W(d.css(c,"fontSize"))*k.length*f.lineHeight;c.style.fontSize=b}}var O,X,A=d.extend,P=Q.round,D=Q.PI,fa=Q.sin,U=Q.cos,ha=d.event.fix,E={},K,T;d.fn.jCanvas=
G;G.version="6.1b";G.events={};O={angle:0,align:"center",autosave:v,baseline:"middle",bringToFront:F,ccw:F,closed:F,compositing:"source-over",cornerRadius:0,cropFromCenter:v,draggable:F,disableDrag:F,each:h,end:360,fillStyle:"transparent",font:"12pt sans-serif",fromCenter:v,height:h,inDegrees:v,lineHeight:1,load:h,mask:F,maxWidth:h,method:h,miterLimit:10,opacity:1,projection:0,r1:h,r2:h,radius:0,repeat:"repeat",rotate:0,rounded:F,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowX:0,
shadowY:0,sHeight:h,sides:3,source:"",start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:h,sx:h,sy:h,text:"",translate:0,translateX:0,translateY:0,visible:v,width:h,x:0,y:0};G();G.extend=function(c){O=A(O,c.props);G();c.name&&(d.fn[c.name]=function b(f){var k,g,d,q=A(new B,f);for(g=0;g<this.length;g+=1)if(k=this[g],d=y(k))H(this[g],f,b),J(d,q),c.fn.call(k,d,q);return this});return d.fn[c.name]};d.fn.getLayers=function(){var c=this[0];return!c||!c.getContext?
[]:R(c).layers};d.fn.getLayer=function(c){var a=this.getLayers(),b;if(!c||!c.layer){if("string"===typeof c)for(b=0;b<a.length;b+=1)if(a[b].name===c){c=b;break}c=a[c||0]}return c};d.fn.setLayer=function(c,a){var b,f;c||(a=c,c=0);for(b=0;b<this.length;b+=1)f=d(this[b]).getLayer(c),A(f,a);return this};d.fn.removeLayer=function(c){var a,b,f,k,g=typeof c;for(a=0;a<this.length;a+=1){b=d(this[a]).getLayers();if("string"===g)for(k=0;k<b.length;k+=1){if(b[k].name===c){f=k;break}}else f="number"===g?c:"";b[f]&&
b.splice(f,1)}return this};d.fn.removeLayers=function(){var c,a;for(a=0;a<this.length;a+=1)c=d(this[a]).getLayers(),c.length=0;return this};d.fn.getLayerGroup=function(c){var a=this.getLayers(),b=[],f;if(c!==z)for(f=0;f<a.length;f+=1)a[f].group===c&&b.push(a[f]);return b};d.fn.setLayerGroup=function(c,a){var b,f,k;for(b=0;b<this.length;b+=1){f=d(this[b]).getLayers();for(k=0;k<f.length;k+=1)f[k].group===c&&A(f[k],a)}return this};d.fn.removeLayerGroup=function(c){var a,b,f;if(c!==z)for(a=0;a<this.length;a+=
1){b=d(this[a]).getLayers();for(f=0;f<b.length;f+=1)b[f].group===c&&(b.splice(f,1),f-=1)}return this};d.fn.drawLayer=function(c){var a,b,f,k;for(a=0;a<this.length;a+=1)f=d(this[a]),b=y(this[a]),k=f.getLayer(c),aa(f,b,k);return this};d.fn.drawLayers=function(c){var a,b,f,k,g,C,q;for(b=0;b<this.length;b+=1)if(a=d(this[b]),f=y(this[b])){f.clearRect(0,0,this[b].width,this[b].height);E.elem===this[b]?q=E.data:(q=R(this[b]),E.elem=this[b],E.data=q);k=q.layers;for(C=0;C<k.length;C+=1)if(g=k[C],g.index=C,
c&&(g._fired=F),aa(a,f,g),g._mousedout)g._mousedout=F,g._fired=v,g._hovered=F,g.mouseout&&g.mouseout.call(this[b],g);g=q.intersects[q.intersects.length-1]||{};a=q.event;a=a.type;C=g[a];f=q.drag;if(g._event){if((g.mouseover||g.mouseout)&&!g._hovered&&!g._fired)g._fired=v,g._hovered=v,g.mouseover&&g.mouseover.call(this[b],g);C&&!g._fired&&(g._fired=v,C.call(this[b],g));g.draggable&&(!g.disableDrag&&"mousedown"===a)&&(g.bringToFront&&(k.splice(g.index,1),g.index=k.push(g)),f.layer=g,f.dragging=v,f.startX=
g.x,f.startY=g.y,f.endX=g.mouseX,f.endY=g.mouseY,g.dragstart&&g.dragstart.call(this[b],g))}if(f.layer&&(f.dragging&&"mouseup"===a&&(f.layer.dragstop&&f.layer.dragstop.call(this[b],f.layer),q.drag={}),f.dragging&&"mousemove"===a))f.layer.x=f.layer.mouseX-(f.endX-f.startX),f.layer.y=f.layer.mouseY-(f.endY-f.startY),f.layer.drag&&f.layer.drag.call(this[b],f.layer)}q.intersects=[];return this};d.fn.addLayer=function(c){var a,b,c=c||{};for(a=0;a<this.length;a+=1)if(b=y(this[a]))c.layer=v,H(this[a],c);
return this};K=["width","height","opacity","lineHeight"];T={};d.fn.animateLayer=function(){function c(a,b){return function(){ba(b);a.drawLayers();g[4]&&g[4].call(a[0],b)}}function a(a,b){return function(c,f){ba(b);a.drawLayers();g[5]&&g[5].call(a[0],c,f,b)}}var b,f,k,g=[].slice.call(arguments,0);"object"===typeof g[0]&&!g[0].layer&&g.unshift(0);"object"===typeof g[2]?(g.splice(2,0,g[2].duration||h),g.splice(3,0,g[3].easing||h),g.splice(4,0,g[4].complete||h),g.splice(5,0,g[5].step||h)):(g[2]===z?(g.splice(2,
0,h),g.splice(3,0,h),g.splice(4,0,h)):"function"===typeof g[2]&&(g.splice(2,0,h),g.splice(3,0,h)),g[3]===z)?(g[3]=h,g.splice(4,0,h)):"function"===typeof g[3]&&g.splice(3,0,h);g[1]=A({},g[1]);for(f=0;f<this.length;f+=1)if(b=d(this[f]),k=y(this[f]))if((k=b.getLayer(g[0]))&&k.method!==d.fn.draw)ca(k),ca(g[1],v),k.style=T,d(k).animate(g[1],{duration:g[2],easing:d.easing[g[3]]?g[3]:h,complete:c(b,k),step:a(b,k)});return this};d.fn.animateLayerGroup=function(c){var a,b,f=[].slice.call(arguments,0),k,g;
for(b=0;b<this.length;b+=1){a=d(this[b]);k=a.getLayerGroup(c);for(g=0;g<k.length;g+=1)a.animateLayer.apply(a,[k[g]].concat(f.slice(1)))}};d.fn.delayLayer=function(c,a){var b,f,a=a||0;for(b=0;b<this.length;b+=1)f=d(this[b]).getLayer(c),d(f).delay(a);return this};d.fn.delayLayerGroup=function(c,a){var b,f,k,g,a=a||0;for(f=0;f<this.length;f+=1){b=d(this[f]);k=b.getLayerGroup(c);for(g=0;g<k.length;g+=1)b.delayLayer.call(b,c,a)}};d.fn.stopLayer=function(c,a){var b,f;for(b=0;b<this.length;b+=1)f=d(this[b]).getLayer(c),
d(f).stop(a);return this};d.fn.stopLayerGroup=function(c,a){var b,f,k,g;for(f=0;f<this.length;f+=1){b=d(this[f]);k=b.getLayerGroup(c);for(g=0;g<k.length;g+=1)b.stopLayer.call(b,c,a)}};(function(c){var a;for(a=0;a<c.length;a+=1)d.fx.step[c[a]]=ga})("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "));N("click");N("dblclick");N("mousedown");N("mouseup");N("mousemove");N("mouseover");N("mouseout");
d.event.fix=function(c){var a,c=ha.call(d.event,c);if(c.pageX!==z&&c.offsetX===z&&(a=d(c.target).offset()))c.offsetX=c.pageX-a.left,c.offsetY=c.pageY-a.top;return c};d.fn.draw=function a(b){var f,k,b=b||{};"function"===typeof b&&(b={fn:b});for(f=0;f<this.length;f+=1)if((k=y(this[f]))&&b.fn)H(this[f],b,a),b.fn.call(this[f],k);return this};d.fn.clearCanvas=function(a){for(var b,f=A(new B,a),a=0;a<this.length;a+=1)if(b=y(this[a]))I(a,b,f,f.width,f.height),!f.x||!f.y||!f.width||!f.height?b.clearRect(0,
0,this[a].width,this[a].height):b.clearRect(f.x-f.width/2,f.y-f.height/2,f.width,f.height);return this};d.fn.saveCanvas=function(){var a,b;for(a=0;a<this.length;a+=1)(b=y(this[a]))&&b.save();return this};d.fn.restoreCanvas=function(){var a,b;for(a=0;a<this.length;a+=1)(b=y(this[a]))&&b.restore();return this};d.fn.translateCanvas=function(a){for(var b,f=A(new B,a),a=0;a<this.length;a+=1)if(b=y(this[a]))f.autosave&&b.save(),Y(b,f);return this};d.fn.scaleCanvas=function(a){for(var b,f=A(new B,a),a=0;a<
this.length;a+=1)if(b=y(this[a]))f.autosave&&b.save(),Z(b,f);return this};d.fn.rotateCanvas=function(a){for(var b,f=A(new B,a),a=0;a<this.length;a+=1)if(b=y(this[a]))f.autosave&&b.save(),$(b,f);return this};d.fn.drawRect=function b(f){var k,g,d=A(new B,f),q,h,s,r,l;for(k=0;k<this.length;k+=1)if(g=y(this[k]))H(this[k],f,b),J(g,d),I(k,g,d,d.width,d.height),g.beginPath(),q=d.x-d.width/2,h=d.y-d.height/2,(l=d.cornerRadius)?(d.closed=v,s=d.x+d.width/2,r=d.y+d.height/2,0>s-q-2*l&&(l=(s-q)/2),0>r-h-2*l&&
(l=(r-h)/2),g.moveTo(q+l,h),g.lineTo(s-l,h),g.arc(s-l,h+l,l,3*D/2,2*D,F),g.lineTo(s,r-l),g.arc(s-l,r-l,l,0,D/2,F),g.lineTo(q+l,r),g.arc(q+l,r-l,l,D/2,D,F),g.lineTo(q,h+l),g.arc(q+l,h+l,l,D,3*D/2,F)):g.rect(q,h,d.width,d.height),d._event&&L(this[k],g,f),M(g,d);return this};d.fn.drawArc=function f(d){var g,h,q=A(new B,d),d=d||{};!q.inDegrees&&360===q.end&&(d.end=q.end=2*D);for(g=0;g<this.length;g+=1)if(h=y(this[g]))H(this[g],d,f),J(h,q),I(g,h,q,2*q.radius),h.beginPath(),h.arc(q.x,q.y,q.radius,q.start*
q._toRad-D/2,q.end*q._toRad-D/2,q.ccw),q._event&&L(this[g],h,d),M(h,q);return this};d.fn.drawEllipse=function k(g){var d,h,u=A(new B,g),s=4*u.width/3,r=u.height;u.closed=v;for(d=0;d<this.length;d+=1)if(h=y(this[d]))H(this[d],g,k),J(h,u),I(d,h,u,u.width,u.height),h.beginPath(),h.moveTo(u.x,u.y-r/2),h.bezierCurveTo(u.x-s/2,u.y-r/2,u.x-s/2,u.y+r/2,u.x,u.y+r/2),h.bezierCurveTo(u.x+s/2,u.y+r/2,u.x+s/2,u.y-r/2,u.x,u.y-r/2),u._event&&L(this[d],h,g),M(h,u);return this};d.fn.drawPolygon=function g(d){var h,
u,s=A(new B,d),r=2*D/s.sides,l=D/s.sides,m=l+D/2,n=s.radius*U(r/2),o,p,j;s.closed=v;for(h=0;h<this.length;h+=1)if(u=y(this[h])){H(this[h],d,g);J(u,s);I(h,u,s,2*s.radius);u.beginPath();for(j=0;j<s.sides;j+=1)o=s.x+P(s.radius*U(m)),p=s.y+P(s.radius*fa(m)),u.lineTo(o,p),s.projection&&(o=s.x+P((n+n*s.projection)*U(m+l)),p=s.y+P((n+n*s.projection)*fa(m+l)),u.lineTo(o,p)),m+=r;s._event&&L(this[h],u,d);M(u,s)}return this};d.fn.drawLine=function C(d){var h,s,r=A(new B,d),l,m,n;for(h=0;h<this.length;h+=1)if(s=
y(this[h])){H(this[h],d,C);J(s,r);I(h,s,r,0);l=1;for(s.beginPath();v;)if(m=r["x"+l],n=r["y"+l],m!==z&&n!==z)s.lineTo(m,n),l+=1;else break;r._event&&L(this[h],s,d);M(s,r)}return this};d.fn.drawQuad=function q(d){var h,r,l=A(new B,d),m,n,o,p,j;for(h=0;h<this.length;h+=1)if(r=y(this[h])){H(this[h],d,q);J(r,l);I(h,r,l,0);m=2;r.beginPath();for(r.moveTo(l.x1,l.y1);v;)if(n=l["x"+m],o=l["y"+m],p=l["cx"+(m-1)],j=l["cy"+(m-1)],n!==z&&o!==z&&p!==z&&j!==z)r.quadraticCurveTo(p,j,n,o),m+=1;else break;l._event&&
L(this[h],r,d);M(r,l)}return this};d.fn.drawBezier=function u(d){var h,l,m=A(new B,d),n,o,p,j,i,t,w,x;for(h=0;h<this.length;h+=1)if(l=y(this[h])){H(this[h],d,u);J(l,m);I(h,l,m,0);n=2;o=1;l.beginPath();for(l.moveTo(m.x1,m.y1);v;)if(p=m["x"+n],j=m["y"+n],i=m["cx"+o],t=m["cy"+o],w=m["cx"+(o+1)],x=m["cy"+(o+1)],p!==z&&j!==z&&i!==z&&t!==z&&w!==z&&x!==z)l.bezierCurveTo(i,t,w,x,p,j),n+=1,o+=2;else break;m._event&&L(this[h],l,d);M(l,m)}return this};d.fn.drawText=function s(r){var l,m,n=A(new B,r),o,p,j,i;
for(l=0;l<this.length;l+=1)if(d(this[l]),m=y(this[l])){H(this[l],r,s);J(m,n);m.textBaseline=n.baseline;m.textAlign=n.align;m.font=n.font;if(!l&&n.maxWidth!==h){o=m;p=n.text;i=n.maxWidth;var t=n.text.split(" "),w=[],x="";if(o.measureText(p).width<i)w=[p];else for(;0<t.length;)o.measureText(x+t[0]).width<i?x+=t.shift()+" ":(w.push(x),x=""),0===t.length&&w.push(x);o=w;o=o.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n")}else l||(o=(""+n.text).split("\n"));ea(this[l],l,m,n,o);I(l,m,n,n.width,n.height);
l||(j=n.x,"left"===n.align?j-=n.width/2:"right"===n.align&&(j+=n.width/2));for(p=0;p<o.length;p+=1)m.shadowColor=n.shadowColor,i=n.y+p*n.height/o.length-(o.length-1)*n.height/o.length/2,m.fillText(o[p],j,i),"transparent"!==n.fillStyle&&(m.shadowColor="transparent"),m.strokeText(o[p],n.x,i);n._event?(m.beginPath(),m.rect(n.x-n.width/2,n.y-n.height/2,n.width,n.height),m.restore(),L(this[l],m,r),m.closePath()):m.restore()}E=n;return this};d.fn.measureText=function(d){var h;h=d!==z&&"object"!==typeof d?
this.getLayer(d):A(new B,d);(d=y(this[0]))&&h.text!==z&&ea(this[0],e,d,h,h.text.split("\n"));return h};d.fn.drawImage=function r(d){function m(m,r,j){return function(){r||((x=t.width/t.height,i.width===h&&i.sWidth===h&&(d.width=i.width=i.sWidth=t.width),i.height===h&&i.sHeight===h&&(d.height=i.height=i.sHeight=t.height),i.width===h&&i.sWidth!==h&&(i.width=i.sWidth),i.height===h&&i.sHeight!==h&&(i.height=i.sHeight),i.sWidth===h&&i.width!==h&&(d.sWidth=i.sWidth=t.width),i.sHeight===h&&i.height!==h&&
(d.sHeight=i.sHeight=t.height),i.sx===h&&(i.sx=i.cropFromCenter?t.width/2:0),i.sy===h&&(i.sy=i.cropFromCenter?t.height/2:0),i.cropFromCenter||(i.sx+=i.sWidth/2,i.sy+=i.sHeight/2),i.sx+i.sWidth/2>t.width&&(i.sx=t.width-i.sWidth/2),0>i.sx-i.sWidth/2&&(i.sx=i.sWidth/2),0>i.sy-i.sHeight/2&&(i.sy=i.sHeight/2),i.sy+i.sHeight/2>t.height&&(i.sy=t.height-i.sHeight/2),i.width!==h&&i.height===h)?d.height=i.height=i.width/x:i.width===h&&i.height!==h?d.width=i.width=i.height*x:i.width===h&&i.height===h&&(d.width=
i.width=t.width,d.height=i.height=t.height));I(r,j,i,i.width,i.height);j.drawImage(t,i.sx-i.sWidth/2,i.sy-i.sHeight/2,i.sWidth,i.sHeight,i.x-i.width/2,i.y-i.height/2,i.width,i.height);i._event?(j.beginPath(),j.rect(i.x-i.width/2,i.y-i.height/2,i.width,i.height),j.restore(),L(n[r],j,d),j.closePath()):j.restore();i.load&&i.load.call(m,d)}}var n=this,o,p,j,i=A(new B,d),t,w,x;w=i.source.getContext;i.source.src||w?(t=i.source,i.width=t.width,i.height=t.height):i.source&&(t=new V,t.src=i.source);for(p=
0;p<n.length;p+=1)if(o=n[p],j=y(n[p]))H(n[p],d,r),J(j,i),t&&(t.complete||w?m(o,p,j)():t.onload=m(o,p,j));return n};d.fn.createPattern=d.fn.pattern=function(d){function l(){j=n.createPattern(p,o.repeat);o.load&&o.load.call(m[0],j)}var m=this,n,o=A(new B,d),p,j;(n=y(m[0]))?"function"===typeof o.source?(p=S.createElement("canvas"),p.width=o.width,p.height=o.height,d=y(p),o.source.call(p,d),l()):(d=o.source.getContext,o.source.src||d?p=o.source:(p=new V,p.src=o.source),p.complete||d?l():p.onload=l):j=
h;return j};d.fn.createGradient=d.fn.gradient=function(d){var l,d=A(new B,d),m=[],n,o,p,j,i,t,w;if(l=y(this[0])){d.x1=d.x1||0;d.y1=d.y1||0;d.x2=d.x2||0;d.y2=d.y2||0;l=d.r1!==h||d.r2!==h?l.createRadialGradient(d.x1,d.y1,d.r1,d.x2,d.y2,d.r2):l.createLinearGradient(d.x1,d.y1,d.x2,d.y2);for(j=1;d["c"+j]!==z;j+=1)d["s"+j]!==z?m.push(d["s"+j]):m.push(h);n=m.length;m[0]===h&&(m[0]=0);m[n-1]===h&&(m[n-1]=1);for(j=0;j<n;j+=1){if(m[j]!==h){t=1;w=0;o=m[j];for(i=j+1;i<n;i+=1)if(m[i]!==h){p=m[i];break}else t+=
1;o>p&&(m[i]=m[j])}else m[j]===h&&(w+=1,m[j]=o+w*((p-o)/t));l.addColorStop(m[j],d["c"+(j+1)])}}else l=h;return l};d.fn.setPixels=function l(d){var h,o,p,j=A(new B,d),i={},t,w,x,v;for(o=0;o<this.length;o+=1)if(h=this[o],p=y(h)){H(this[o],d,l);I(o,p,j,j.width,j.height);if(!j.x||!j.y||!j.width||!j.height)j.width=h.width,j.height=h.height,j.x=j.width/2,j.y=j.height/2;t=p.getImageData(j.x-j.width/2,j.y-j.height/2,j.width,j.height);w=t.data;v=w.length;i=[];if(j.each)for(x=0;x<v;x+=4)i.r=w[x],i.g=w[x+1],
i.b=w[x+2],i.a=w[x+3],j.each.call(h,i),w[x]=i.r,w[x+1]=i.g,w[x+2]=i.b,w[x+3]=i.a;p.putImageData(t,j.x-j.width/2,j.y-j.height/2);p.restore()}return this};d.fn.getCanvasImage=function(d,m){var n=this[0];return n&&n.toDataURL?n.toDataURL("image/"+d,m):h};d.support.canvas=S.createElement("canvas").getContext!==z;G.defaults=O;d.jCanvas=G})(jQuery,document,Image,Math,parseFloat,!0,!1,null);
